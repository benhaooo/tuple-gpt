<template>
  <div class="bg-dark-nav flex md:flex-col justify-center items-center">
    <div
      class="avatar-wrapper group relative flex justify-center items-end w-20 h-20 overflow-hidden mt-5">
      <div class=" absolute bottom-0  border-2 w-16 h-16 border-light-border rounded-full z-10 translate-y-1"></div> 
      <img class=" w-12 rounded-full cursor-pointer duration-300 group-hover:scale-150 z-20" :src="configStore.getAvatar" alt="用户头像" />
      <div class=" absolute bottom-0 border-b-4  w-16 h-16 border-light-border rounded-full z-30 translate-y-1"></div>
    </div>

    <div class="center flex md:flex-col w-full flex-1">
      <template v-for="(item, index) in menuItems" :key="index">
        <div class="group flex max-md:flex-col-reverse items-center w-full cursor-pointer my-5">
          <span class="w-1/4 h-1 md:w-1 md:h-2/3 transition-opacity duration-300 rounded bg-dark-blue-base md:mr-2"
            :class="isSelected(item.route) ? 'opacity-100 ' : 'opacity-0'"></span>
          <i class="iconfont text-2xl group-hover:text-dark-blue-base"
            :class="[item.icon, isSelected(item.route) ? 'text-dark-blue-base' : '']"
            @click="handleClick(item.route)"></i>
        </div>
      </template>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted, watchEffect } from "vue"
import useUserStore from "@/stores/modules/user"
import useConfigStore from "@/stores/modules/config"
import { useRouter, useRoute } from "vue-router"
import { storeToRefs } from 'pinia'



const userStore = useUserStore()
const configStore = useConfigStore()
const { userConfig, moduleConfig, serverConfig } = storeToRefs(configStore)


const router = useRouter()
const route = useRoute()

const menuItems = [
  { icon: "icon-xinxi", route: '/chat/message' },
  { icon: "icon-prompt", route: '/chat/prompt' },
  { icon: "icon-shezhi", route: '/chat/setting' },
  // { icon: "icon-store", route: '/chat/store' },
  // { icon: "icon-application", route: '/chat/file' },
];
const handleClick = (routePath) => {
  router.push(routePath)
}
const isSelected = computed(() => {
  return (routeName) => {
    return route.matched.some((record) => record.path === routeName);
  };
});

//主题切换
watchEffect(() => {
  const theme = userConfig.value.theme
  const html = document.querySelector('html')
  html.className = theme
})



</script>

<style lang="less" scoped>
.avatar-wrapper{
  border-radius: 0 0 50% 50%;
}
</style>